{% extends "base.html" %}

{% block extra_css %}
<link rel="stylesheet" href="{{ url_for('static', filename='css/system_dashboard.css') }}">
{% endblock %}

{% block content %}
<div class="system-container">
    
    <div class="d-flex justify-content-between align-items-center mb-4 pt-4">
    <div>
        <h3 class="fw-bold m-0 text-dark">Tổng quan hệ thống
    </div>
    
    <div>
        <button class="btn-minimal btn-reset" id="btnResetData">
            <i class="fas fa-trash-alt me-2"></i>RESET DATA
        </button>
    </div>
</div>

    <div class="control-bar mb-4">
        <div class="control-group">
            <span class="control-label">Ngày:</span>
            <input type="date" id="settleDate" class="form-control-compact">
        </div>

        <div class="vr mx-2 text-muted opacity-25"></div>

        <div class="control-group">
            <button class="btn-minimal" id="btnAllocate">
                Phân bổ CD
            </button>
            <button class="btn-minimal" id="btnSyncBank">
                Lưu ký NHLK
            </button>
        </div>
    </div>

    <div class="nav-tabs-minimal">
        <div class="tab-link active" onclick="switchTab('all', this)">Tất cả</div>
        <div class="tab-link" onclick="switchTab('user', this)">Ví Khách Hàng</div>
        <div class="tab-link" onclick="switchTab('system', this)">Quỹ Hệ Thống</div>
        <div class="tab-link" onclick="switchTab('bank', this)">Ngân Hàng LK</div>
    </div>

    <div id="content-area">
        
        <div id="section-user" class="section-wrapper mb-4">
            <h6 class="text-uppercase text-muted fw-bold mb-3 small">1. Ví Khách Hàng (User)</h6>
            <div class="dashboard-grid" id="user-data-container"></div>
        </div>

        <div id="section-system" class="section-wrapper mb-4">
            <h6 class="text-uppercase text-muted fw-bold mb-3 small">2. Core TVAM</h6>
            <div class="dashboard-grid" id="finsight-data-container"></div>
        </div>

        <div id="section-bank" class="section-wrapper mb-4">
            <h6 class="text-uppercase text-muted fw-bold mb-3 small">3. Ngân Hàng Lưu Ký</h6>
            <div class="dashboard-grid" id="bank-data-container"></div>
        </div>

    </div>
</div>

<div id="loading-overlay" style="display:none; position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(255,255,255,0.8); z-index:9999; justify-content:center; align-items:center;">
    <div class="spinner-border text-dark spinner-border-sm me-2"></div>
    <span class="fw-bold text-dark">Đang tải...</span>
</div>
{% endblock %}

{% block extra_js %}
<script src="{{ url_for('static', filename='js/system_dashboard.js') }}"></script>
{% endblock %}